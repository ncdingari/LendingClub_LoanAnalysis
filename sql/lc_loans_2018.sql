\connect loans;

DROP TABLE lc_loans_2018;

CREATE TABLE lc_loans_2019Q3(
        id TEXT, 
        member_id TEXT, 
        loan_amnt NUMERIC, 
        funded_amnt NUMERIC, 
        funded_amnt_inv NUMERIC, 
        term TEXT, 
        int_rate TEXT, 
        installment TEXT, 
        grade TEXT, 
        sub_grade TEXT, 
        emp_title TEXT, 
        emp_length TEXT, 
        home_ownership TEXT, 
        annual_inc NUMERIC, 
        verification_status TEXT, 
        issue_d TEXT, 
        loan_status TEXT, 
        pymnt_plan BOOLEAN,
        url TEXT, 
        description TEXT, 
        purpose TEXT, 
        title TEXT, 
        zip_code TEXT, 
        addr_state TEXT, 
        dti TEXT, 
        delinq_2yrs INT, 
        earliest_cr_line TEXT, 
        fico_range_low NUMERIC, 
        fico_range_high NUMERIC, 
        inq_last_6mths INT, 
        mths_since_last_delinq TEXT, 
        mths_since_last_record TEXT, 
        open_acc TEXT, 
        pub_rec INT, 
        revol_bal NUMERIC, 
        revol_util TEXT, 
        total_acc INT, 
        initial_list_status TEXT, 
        out_prncp NUMERIC, 
        out_prncp_inv NUMERIC, 
        total_pymnt NUMERIC, 
        total_pymnt_inv NUMERIC, 
        total_rec_prncp NUMERIC, 
        total_rec_int NUMERIC, 
        total_rec_late_fee NUMERIC, 
        recoveries NUMERIC, 
        collection_recovery_fee NUMERIC, 
        last_pymnt_d TEXT, 
        last_pymnt_amnt NUMERIC, 
        next_pymnt_d TEXT, 
        last_credit_pull_d TEXT, 
        last_fico_range_high NUMERIC,
        last_fico_range_low NUMERIC,
        collections_12_mths_ex_med INT,
        mths_since_last_major_derog TEXT,
        policy_code INT,
        application_type TEXT,
        annual_inc_joint TEXT,
        dti_joint TEXT,
        verification_status_joint TEXT,
        acc_now_delinq INT,
        tot_coll_amt INT,
        tot_cur_bal INT,
        open_acc_6m INT,
        open_act_il INT,
        open_il_12m INT,
        open_il_24m INT,
        mths_since_rcnt_il TEXT,
        total_bal_il INT,
        il_util TEXT,
        open_rv_12m INT,
        open_rv_24m INT,
        max_bal_bc INT,
        all_util TEXT,
        total_rev_hi_lim INT,
        inq_fi INT,
        total_cu_tl INT,
        inq_last_12m INT,
        acc_open_past_24mths INT,
        avg_cur_bal TEXT,
        bc_open_to_buy TEXT,
        bc_util TEXT,
        chargeoff_within_12_mths INT,
        delinq_amnt INT,
        mo_sin_old_il_acct TEXT,
        mo_sin_old_rev_tl_op INT,
        mo_sin_rcnt_rev_tl_op INT,
        mo_sin_rcnt_tl INT,
        mort_acc INT,
        mths_since_recent_bc TEXT,
        mths_since_recent_bc_dlq TEXT,
        mths_since_recent_inq TEXT,
        mths_since_recent_revol_delinq TEXT,
        num_accts_ever_120_pd INT,
        num_actv_bc_tl INT,
        num_actv_rev_tl INT,
        num_bc_sats INT,
        num_bc_tl INT,
        num_il_tl INT,
        num_op_rev_tl INT,
        num_rev_accts INT,
        num_rev_tl_bal_gt_0 INT,
        num_sats INT,
        num_tl_120dpd_2m TEXT,
        num_tl_30dpd INT,
        num_tl_90g_dpd_24m INT,
        num_tl_op_past_12m INT,
        pct_tl_nvr_dlq TEXT,
        percent_bc_gt_75 TEXT,
        pub_rec_bankruptcies INT,
        tax_liens INT,
        tot_hi_cred_lim INT,
        total_bal_ex_mort INT,
        total_bc_limit INT,
        total_il_high_credit_limit INT,
        revol_bal_joint TEXT,
        sec_app_fico_range_low TEXT,
        sec_app_fico_range_high TEXT,
        sec_app_earliest_cr_line TEXT, 
        sec_app_inq_last_6mths TEXT, 
        sec_app_mort_acc TEXT, 
        sec_app_open_acc TEXT, 
        sec_app_revol_util TEXT, 
        sec_app_open_act_il TEXT, 
        sec_app_num_rev_accts TEXT, 
        sec_app_chargeoff_within_12_mths TEXT, 
        sec_app_collections_12_mths_ex_med TEXT, 
        sec_app_mths_since_last_major_derog TEXT, 
        hardship_flag BOOLEAN, 
        hardship_type TEXT, 
        hardship_reason TEXT, 
        hardship_status TEXT, 
        deferral_term TEXT, 
        hardship_amount TEXT, 
        hardship_start_date TEXT, 
        hardship_end_date TEXT, 
        payment_plan_start_date TEXT, 
        hardship_length TEXT, 
        hardship_dpd TEXT, 
        hardship_loan_status TEXT, 
        orig_projected_additional_accrued_interest TEXT, 
        hardship_payoff_balance_amount TEXT, 
        hardship_last_payment_amount TEXT,
        debt_settlement_flag BOOLEAN, 
        debt_settlement_flag_date TEXT, 
        settlement_status TEXT, 
        settlement_date TEXT, 
        settlement_amount TEXT, 
        settlement_percentage TEXT, 
        settlement_term TEXT    
);

\copy lc_loans_2018 FROM '/home/ubuntu/data/lending_club/LoanStats_securev1_2018Q4.csv' CSV;
\copy lc_loans_2018 FROM '/home/ubuntu/data/lending_club/LoanStats_securev1_2018Q3.csv' CSV;
\copy lc_loans_2018 FROM '/home/ubuntu/data/lending_club/LoanStats_securev1_2018Q2.csv' CSV;
\copy lc_loans_2018 FROM '/home/ubuntu/data/lending_club/LoanStats_securev1_2018Q1.csv' CSV;